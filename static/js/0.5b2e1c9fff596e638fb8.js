webpackJsonp([0],{"5s5k":function(e,t){},"8B8S":function(e,t){},FlXb:function(e,t){},KFuh:function(e,t){},T2hp:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"Login",props:["loginshow","dialogshow"],data:function(){return{mylogin:!1,mydialog:!1,loading:!1,loginForm:{username:"",password:""},rules:{username:[{required:!0,message:"账号不能为空",trigger:"blur"},{max:20,message:"账号长度最长20位",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"密码长度最少为6位",trigger:"blur"}]}}},mounted:function(){},methods:{login:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.$axios.post("/api/useract",{trantype:"login",username:t.loginForm.username,password:t.$md5(t.loginForm.password)}).then(function(e){var s=e.data.respcode,i=e.data.respmsg;"000000"===s?(t.$notify({type:"success",message:"欢迎你,"+t.loginForm.username+"!",duration:1500,offset:50}),sessionStorage.setItem("username",t.loginForm.username),t.loading=!1,t.mydialog=!1,t.$emit("state")):(t.$message.error(i),t.loading=!1)}).catch(function(e){t.$message.error("请求异常"),t.loading=!1})})}},watch:{mylogin:{handler:function(e){console.log("loginshow更新：",e),this.$emit("update:loginshow",e)},deep:!0},loginshow:{handler:function(e){this.mylogin=this.loginshow},deep:!0,immediate:!0},mydialog:{handler:function(e){this.$emit("update:dialogshow",e)},deep:!0},dialogshow:{handler:function(e){this.mydialog=this.dialogshow},deep:!0,immediate:!0}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login"},[s("div",{staticClass:"main_login"},[s("div",{staticClass:"title"},[e._v("登 录")]),e._v(" "),s("el-row",{attrs:{type:"flex",justify:"center"}},[s("el-form",{ref:"loginForm",attrs:{rules:e.rules,model:e.loginForm}},[s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{icon:"el-icon-search",placeholder:"请输入用户名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login("loginForm")}},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[s("i",{staticClass:"el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login("loginForm")}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[s("i",{staticClass:"el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),s("el-form-item",{staticStyle:{"text-align":"center"}},[s("el-button",{staticStyle:{"text-align":"center",width:"150px"},attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.login("loginForm")}}},[e._v("登  录")])],1)],1)],1),e._v(" "),s("div",{staticClass:"link"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){e.mylogin=!1}}},[e._v("注册新账号")])],1)],1)])},staticRenderFns:[]};var n=s("VU/8")(i,a,!1,function(e){s("8B8S")},"data-v-693c496a",null).exports,r={name:"Register",props:["loginshow"],data:function(){var e=this;return{mylogin:!1,loading:!1,registerForm:{username:"",pass:"",checkPass:""},rules:{username:[{required:!0,message:"账号不能为空",trigger:"blur"},{max:20,message:"账号长度最长20位",trigger:"blur"}],pass:[{required:!0,validator:function(t,s,i){""===s?i(new Error("请输入密码")):(""!==e.registerForm.checkPass&&e.$refs.registerForm.validateField("checkPass"),i())},trigger:"blur"},{min:6,message:"密码长度最少为6位",trigger:"blur"},{max:16,message:"密码长度不能超过16位",trigger:"blur"}],checkPass:[{required:!0,validator:function(t,s,i){""===s?i(new Error("请再次输入密码")):s!==e.registerForm.pass?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"}]}}},mounted:function(){},methods:{Register:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.error("注册信息有误！"),!1;t.loading=!0,t.$axios.post("/api/useract",{trantype:"register",username:t.registerForm.username,password:t.$md5(t.registerForm.pass)}).then(function(e){var s=e.data.respcode,i=e.data.respmsg;"000000"===s?(t.$message.success(i),t.loading=!1,t.mylogin=!0):(t.$message.error(i),t.loading=!1)}).catch(function(e){t.$message.error("请求异常"),t.loading=!1})})},resetForm:function(e){this.$refs[e].resetFields()}},watch:{mylogin:{handler:function(e){this.$emit("update:loginshow",e)},deep:!0},loginshow:{handler:function(e){this.mylogin=this.loginshow},deep:!0,immediate:!0}}},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"register"},[s("div",{staticClass:"main-register"},[s("div",{staticClass:"title"},[e._v("注 册")]),e._v(" "),s("el-row",[s("el-form",{ref:"registerForm",staticClass:"demo-registeForm",attrs:{model:e.registerForm,"status-icon":"",rules:e.rules,size:"medium","label-width":"100px"}},[s("el-form-item",{attrs:{prop:"username",label:"用户名"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.Register("registerForm")}},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"pass"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请输入密码(不少于6位)","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.Register("registerForm")}},model:{value:e.registerForm.pass,callback:function(t){e.$set(e.registerForm,"pass",t)},expression:"registerForm.pass"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[s("el-input",{attrs:{autocomplete:"off",placeholder:"请再次输入密码","show-password":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.Register("registerForm")}},model:{value:e.registerForm.checkPass,callback:function(t){e.$set(e.registerForm,"checkPass",t)},expression:"registerForm.checkPass"}})],1),e._v(" "),s("el-form-item",{staticStyle:{"margin-left":"-25%"}},[s("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.Register("registerForm")}}},[e._v("注册")]),e._v(" "),s("el-button",{staticStyle:{"margin-right":"-5%"},on:{click:function(t){return e.resetForm("registerForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),s("div",{staticClass:"link"},[s("el-button",{attrs:{type:"text"},on:{click:function(t){e.mylogin=!0}}},[e._v("已有账号?去登录")])],1)],1)])},staticRenderFns:[]};var l=s("VU/8")(r,o,!1,function(e){s("t2Lz")},"data-v-26111123",null).exports,c=s("pFYg"),d=s.n(c),g={name:"upload",props:{filelist:{type:Array,default:function(){}},username:{type:String,default:""}},data:function(){return{myfilelist:[],uid:"",checksum:""}},created:function(){},methods:{handleExceed:function(e,t){this.$message.warning("上传文件格式不正确!")},uploadFile:function(e){var t=this,s=e.file,i=s.name,a=new FileReader;a.readAsBinaryString(s),a.onload=function(s){var a=s.target.result;t.doUpload(e,a,i)}},doUpload:function(e,t,s){var i=this,a={trantype:"file_upload",username:this.username,file:t,filename:s};this.$axios.request({method:"post",url:"/api/filecfg",data:a,onUploadProgress:function(t){var s=t.loaded/t.total*100|0;e.onProgress({percent:s})}}).then(function(t){var s=t.data.respcode,a=t.data.respmsg;"000000"==s?(e.onSuccess(),i.$message.success(a),i.myfilelist=[],i.$emit("getfilelist")):(e.onError(),i.$message.error(a))}).catch(function(t){e.onError(),i.$message.error("请求异常")})},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传文件大小不能超过 20MB!"),t},beforeRemove:function(e,t){console.log("myfilelist1=",d()(this.myfilelist))},handleRemove:function(e,t){this.myfilelist=t}},watch:{myfilelist:{handler:function(e){this.$emit("update:filelist",e)},deep:!0},filelist:{handler:function(e){this.myfilelist=this.filelist},deep:!0,immediate:!0}}},u={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"File-upload"},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","http-request":this.uploadFile,accept:".docx,.txt",limit:1,"on-exceed":this.handleExceed,"before-upload":this.beforeAvatarUpload,"before-remove":this.beforeRemove,"on-remove":this.handleRemove,"file-list":this.myfilelist,"auto-upload":!0}},[t("el-button",{attrs:{slot:"trigger",type:"text"},slot:"trigger"},[t("i",{staticClass:"el-icon-upload2"}),this._v("上传文档")])],1)],1)},staticRenderFns:[]};var h={name:"zreader",props:["username"],components:{upload:s("VU/8")(g,u,!1,function(e){s("KFuh")},"data-v-130227d7",null).exports},data:function(){return{filelist:[],rownum:6,leftnum:12,handflag:!0,loading:!1,options:[],file:[],question:"",answer:"",ansindex:0,answerlist:[],storagekeys:[],histags:[]}},mounted:function(){},methods:{clearall:function(){this.question="",this.answer=""},getfilelist:function(){var e=this;this.file=[],this.options=[],this.$axios.post("/api/readact",{trantype:"getfilelist",username:this.username}).then(function(t){var s=t.data.respcode,i=t.data.respmsg;if("000000"===s){var a=t.data.fileoptions;e.options=a}else e.$message.error(i)}).catch(function(t){e.$message.error("请求异常")})},clearchildren:function(e){for(var t=0;t<e.length;t++)void 0!==e[t].children&&(e[t].children.length?this.clearchildren(e[t].children):(e[t].children=null,e.splice(t,1)));return e},getanswer:function(){var e=this;this.answer="",this.loading=!0,this.handflag=!0,this.ansindex=0,this.$axios.post("/api/readact",{trantype:"create_answer",question:this.question,filelist:this.file},{timeout:3e5}).then(function(t){var s=t.data.respcode,i=t.data.respmsg;"000000"===s?(e.answerlist=t.data.answerlist,e.answer=e.answerlist[e.ansindex].answer,e.storagekeys.push(e.question),e.$removeLocalStorage((e.username+"keys").toString()),e.$setObjectLocalStorage((e.username+"keys").toString(),e.storagekeys),e.$setObjectLocalStorage(e.question,e.answerlist),e.getstorage(),e.loading=!1,e.handflag=!1):(e.$message.error(i),e.loading=!1,e.handflag=!1)}).catch(function(t){e.$message.error("请求异常"),e.loading=!1,e.handflag=!1})},nextanswer:function(){this.ansindex<this.answerlist.length-1?(this.ansindex=this.ansindex+1,this.answer=this.answerlist[this.ansindex].answer):(this.ansindex=this.answerlist.length-1,this.answer=this.answerlist[this.ansindex].answer)},lastanswer:function(){this.ansindex>0?(this.ansindex=this.ansindex-1,this.answer=this.answerlist[this.ansindex].answer):(this.ansindex=0,this.answer=this.answerlist[this.ansindex].answer)},getstorage:function(){if(this.$getObjectLocalStorage((this.username+"keys").toString())){var e=this.$getObjectLocalStorage((this.username+"keys").toString());this.histags=[],this.storagekeys=[];for(var t=0;t<e.length;t++)this.histags.push({name:e[t],type:"info"}),this.storagekeys.push(e[t])}},getanswerlist:function(e){if(this.$getObjectLocalStorage(e)){var t=this.$getObjectLocalStorage(e);this.answerlist=[],this.answer="",this.ansindex=0,this.question=e,this.answerlist=t,this.lastanswer()}},handleClose:function(e){var t=this.histags.indexOf(e);this.histags.splice(t,1);for(var s=0,i=0;i<this.storagekeys.length;i++)this.storagekeys[i]===e.name&&(s+=1);this.storagekeys.splice(t,1),0===this.storagekeys.length?this.$removeLocalStorage((this.username+"keys").toString()):this.$setObjectLocalStorage((this.username+"keys").toString(),this.storagekeys),s<=1&&this.$removeLocalStorage(e.name)},clearhistags:function(){for(var e=0;e<this.storagekeys.length;e++)this.$removeLocalStorage(this.storagekeys[e]);this.$removeLocalStorage((this.username+"keys").toString())}},watch:{question:{handler:function(e){""===this.question||void 0===this.question||0===this.file.length?(this.leftnum=12,this.handflag=!0):(this.handflag=!1,this.leftnum=0)},deep:!0},file:{handler:function(e){""===this.question||void 0===this.question||0===this.file.length?this.handflag=!0:(this.handflag=!1,this.leftnum=0)},deep:!0},username:{handler:function(e){""===this.username||void 0===this.username?(this.file=[],this.options=[]):(this.getfilelist(),this.getstorage())},deep:!0,immediate:!0}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("div",{staticClass:"body"},[s("el-row",{staticClass:"row1",attrs:{gutter:20}},[s("el-col",{staticStyle:{"text-align":"left"},attrs:{span:24}},[s("el-cascader",{attrs:{size:"small","show-all-levels":!1,clearable:"",placeholder:"我的文档",options:e.options},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,a=t.data;return[s("span",[e._v(e._s(a.label))]),e._v(" "),i.isLeaf?e._e():s("span",[e._v(" ("+e._s(a.children.length)+") ")])]}}]),model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),e._v(" "),s("el-button",{staticStyle:{"margin-left":"1rem"},attrs:{type:"primary",size:"small",disabled:e.handflag,loading:e.loading},on:{click:e.getanswer}},[e._v("提交问题")]),e._v(" "),s("el-button",{attrs:{size:"small",disabled:e.loading},on:{click:e.clearall}},[e._v("清空")])],1)],1),e._v(" "),s("el-row",{staticClass:"row2",attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-input",{staticClass:"textarea-left",attrs:{type:"textarea",rows:e.rownum,clearable:"",maxlength:"200",placeholder:"请输入问题","show-word-limit":""},model:{value:e.question,callback:function(t){e.question=t},expression:"question"}},[e._v("111\n        ")])],1),e._v(" "),s("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{span:12,"element-loading-text":"拼命寻找答案中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(235, 238, 245, 0.2)"}},[s("el-input",{staticClass:"textarea-right",attrs:{type:"textarea",rows:e.rownum,readonly:"",maxlength:"200"},model:{value:e.answer,callback:function(t){e.answer=t},expression:"answer"}})],1)],1),e._v(" "),s("el-row",{staticClass:"row3",attrs:{gutter:20}},[s("el-col",{staticStyle:{"text-align":"left"},attrs:{span:e.leftnum}},[s("el-tooltip",{attrs:{content:"目前仅支持word、txt格式,且大小不超过20M",placement:"bottom",effect:"light"}},[s("upload",{attrs:{filelist:e.filelist,username:e.username},on:{"update:filelist":function(t){e.filelist=t},getfilelist:e.getfilelist}})],1)],1),e._v(" "),s("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24-e.leftnum}},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:""!==e.answer&&this.ansindex>0,expression:"answer!=='' && this.ansindex>0"}],attrs:{type:"text"},on:{click:e.lastanswer}},[e._v("查看上一个")]),e._v(" "),s("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:""!==e.answer&&this.ansindex<this.answerlist.length-1,expression:"answer!=='' && this.ansindex<this.answerlist.length-1"}],attrs:{type:"text"},on:{click:e.nextanswer}},[e._v("不满意?下一个")])],1)],1),e._v(" "),s("el-divider"),e._v(" "),s("div",{staticClass:"hisbox"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticClass:"histext",attrs:{span:18}},[s("i",{staticClass:"el-icon-time"}),e._v(" "),s("span",[e._v("历史记录")])]),e._v(" "),s("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[s("el-button",{attrs:{type:"text"},on:{click:e.clearhistags}},[e._v("清空")])],1)],1),e._v(" "),s("div",{staticClass:"tag-box"},[e._l(e.histags,function(t,i){return s("el-tag",{directives:[{name:"show",rawName:"v-show",value:0!==e.histags.length,expression:"histags.length!==0"}],key:i,staticClass:"tag-item",attrs:{closable:"",type:t.type},on:{close:function(s){return e.handleClose(t)},click:function(s){return e.getanswerlist(t.name)}}},[e._v("\n          "+e._s(t.name)+"\n        ")])}),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:0===e.histags.length,expression:"histags.length===0"}],staticStyle:{color:"#C0C4CC","font-size":"14px",width:"100%"}},[e._v("暂无历史记录")])],2)],1)],1)])},staticRenderFns:[]};var f={name:"Base",components:{Login:n,Register:l,zreader:s("VU/8")(h,m,!1,function(e){s("wsYX"),s("5s5k")},"data-v-0ad09cda",null).exports},data:function(){return{showname:!1,username:"",loginshow:!0,dialogshow:!1}},methods:{logincheck:function(){var e=this;this.$axios.post("/api/useract",{trantype:"logincheck"}).then(function(t){var s=t.data.respcode,i=t.data.respmsg;"000000"===s?(sessionStorage.setItem("username",t.data.username),e.state()):e.$message.warning(i)}).catch(function(t){e.$message.error("请求异常")})},state:function(){null!=sessionStorage.getItem("username")?(this.username=sessionStorage.getItem("username"),this.showname=!0):(this.username="",this.showname=!1)},handleCommand:function(e){"a"===e&&this.exit()},exit:function(){var e=this;this.$axios.post("/api/useract",{trantype:"exit",username:sessionStorage.getItem("username")}).then(function(t){var s=t.data.respcode,i=t.data.respmsg;"000000"===s?(sessionStorage.clear(),e.state(),e.$message.success(i)):e.$message.error(i)}).catch(function(t){e.$message.error("请求异常")})},login:function(){this.loginshow=!0,this.dialogshow=!0},register:function(){this.loginshow=!1,this.dialogshow=!0}},created:function(){this.logincheck()},mounted:function(){}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main"},[s("el-container",[s("el-header",[s("div",{staticClass:"logo"},[s("img",{staticClass:"logoImg",attrs:{src:"/static/images/logo.png"}}),e._v(" "),s("span",{staticStyle:{color:"#303133"}},[e._v("ZBOOK")]),e._v(" "),s("span",{staticStyle:{"font-size":"13px","margin-left":"5px",color:"#606266"}},[e._v("——智能交互阅读平台")])]),e._v(" "),s("div",{staticStyle:{float:"right","margin-right":"50px","line-height":"60px"}},[e.showname?[s("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[e._v("\n              "+e._s(e.username)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown",size:"small"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"a"}},[e._v("退出登录")])],1)],1)]:[s("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.login}},[e._v("登录")]),e._v(" "),s("el-button",{attrs:{plain:"",size:"small"},on:{click:e.register}},[e._v("注册")])]],2)]),e._v(" "),s("el-main",{staticStyle:{padding:"0"}},[s("zreader",{attrs:{username:e.username},on:{"update:username":function(t){e.username=t}}}),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogshow,width:"30%",center:""},on:{"update:visible":function(t){e.dialogshow=t}}},[e.loginshow?s("login",{attrs:{loginshow:e.loginshow,dialogshow:e.dialogshow},on:{"update:loginshow":function(t){e.loginshow=t},"update:dialogshow":function(t){e.dialogshow=t},state:e.state}}):s("register",{attrs:{loginshow:e.loginshow},on:{"update:loginshow":function(t){e.loginshow=t}}})],1)],1)],1)],1)},staticRenderFns:[]};var v=s("VU/8")(f,p,!1,function(e){s("FlXb")},"data-v-55f5bf04",null);t.default=v.exports},t2Lz:function(e,t){},wsYX:function(e,t){}});
//# sourceMappingURL=0.5b2e1c9fff596e638fb8.js.map